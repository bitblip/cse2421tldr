<!DOCTYPE html>
<html lang="en">
<head>
  
    <title>Pointers On C :: CSE 2421 TL;DR</title>
  
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="description" content="The Preprocessor First step in compiling. Removes comments, inserts #include contents, substitutes #define symbols, and processes conditional compilation directives.
Predefined symbols    Symbol Sample Value Meaning     __FILE__ &amp;ldquo;name.c&amp;rdquo; Name of the source file being compiled.   __LINE__ 25 Line number of the current line in the file.   __DATE__ &amp;ldquo;Jan 1 2020&amp;rdquo; Date the file was compiled.   __TIME__ &amp;ldquo;18:04:30&amp;rdquo; Time that the file was compiled." />
<meta name="keywords" content="" />
<meta name="robots" content="noodp" />
<link rel="canonical" href="/posts/reading-pointers-on-c/" />




<link rel="stylesheet" href="/assets/style.css">






<link rel="apple-touch-icon" href="/img/apple-touch-icon-192x192.png">

  <link rel="shortcut icon" href="/img/favicon/orange.png">



<meta name="twitter:card" content="summary" />

  
    <meta name="twitter:site" content="" />
  
    <meta name="twitter:creator" content="" />



<meta property="og:locale" content="en" />
<meta property="og:type" content="article" />
<meta property="og:title" content="Pointers On C">
<meta property="og:description" content="Chapter 14, The Preprocessor (omit 14.5)" />
<meta property="og:url" content="/posts/reading-pointers-on-c/" />
<meta property="og:site_name" content="CSE 2421 TL;DR" />

  
    <meta property="og:image" content="/img/favicon/orange.png">
  

<meta property="og:image:width" content="2048">
<meta property="og:image:height" content="1024">


  <meta property="article:published_time" content="2020-01-15 02:30:11 -0500 -0500" />












</head>
<body class="orange">


<div class="container center headings--one-size">

  <header class="header">
  <div class="header__inner">
    <div class="header__logo">
      <a href="/">
  <div class="logo">
    CSE 2421 TL;DR
  </div>
</a>

    </div>
    
  </div>
  
</header>


  <div class="content">
    
<div class="post">
  <h1 class="post-title">
    <a href="/posts/reading-pointers-on-c/">Pointers On C</a></h1>
  <div class="post-meta">
    
      <span class="post-date">
        2020-01-15 [Updated: 2020-01-15]
      </span>
    
    
  </div>

  
  <span class="post-tags">
    
    #<a href="/tags/preprocessor/">preprocessor</a>&nbsp;
    
    #<a href="/tags/c/">c</a>&nbsp;
    
  </span>
  

  

  

  <div class="post-content"><div>
        <h1 id="the-preprocessor">The Preprocessor<a href="#the-preprocessor" class="hanchor" ariaLabel="Anchor">&#8983;</a> </h1>
<p>First step in compiling. Removes comments, inserts #include contents, substitutes #define symbols, and processes conditional compilation directives.</p>
<h2 id="predefined-symbols">Predefined symbols<a href="#predefined-symbols" class="hanchor" ariaLabel="Anchor">&#8983;</a> </h2>
<table>
<thead>
<tr>
<th>Symbol</th>
<th>Sample Value</th>
<th>Meaning</th>
</tr>
</thead>
<tbody>
<tr>
<td>__FILE__</td>
<td>&ldquo;name.c&rdquo;</td>
<td>Name of the source file being compiled.</td>
</tr>
<tr>
<td>__LINE__</td>
<td>25</td>
<td>Line number of the current line in the file.</td>
</tr>
<tr>
<td>__DATE__</td>
<td>&ldquo;Jan 1 2020&rdquo;</td>
<td>Date the file was compiled.</td>
</tr>
<tr>
<td>__TIME__</td>
<td>&ldquo;18:04:30&rdquo;</td>
<td>Time that the file was compiled.</td>
</tr>
<tr>
<td>__STDC__</td>
<td></td>
<td>1 if conforming to ANSI C, else undefined.</td>
</tr>
</tbody>
</table>
<h2 id="define">#define<a href="#define" class="hanchor" ariaLabel="Anchor">&#8983;</a> </h2>
<p>All occurrences of <code>name</code> are replaced with <code>stuff</code>. <code>name</code> cannot contain white space characters but <code>stuff</code> can be anything.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-c" data-lang="c"><span style="color:#75715e">#define name stuff
</span></code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-c" data-lang="c"><span style="color:#75715e">#define SOME_LOOPS for (i = 0; i &lt; 10; i += 1&gt;) { \
</span><span style="color:#75715e">                      sum += 1;                   \
</span><span style="color:#75715e">                   }
</span></code></pre></div><blockquote>
<p>Don&rsquo;t misuse this. Prefer functions for statement reuse.</p>
</blockquote>
<h3 id="macros">Macros<a href="#macros" class="hanchor" ariaLabel="Anchor">&#8983;</a> </h3>
<p>Define but with a comma delimited list of arguments. Remember, <code>name</code> cannot have spaces.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-c" data-lang="c"><span style="color:#75715e">#define name(parameter-list) stuff
</span></code></pre></div><p>Macro replacements are textual, think carefully about the result of the text swap. Not only the insertion of the macro text into code, but also the argument text into the macro.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-c" data-lang="c"><span style="color:#75715e">#define DOUBLE(x) ( (x) + (x) )
</span></code></pre></div><blockquote>
<p>Macro&rsquo;s that evaluate numeric expressions should be parenthesized to avoid unexpected interactions.</p>
</blockquote>
<blockquote>
<p>Avoid macros that obscure C syntactical standards. It hinders other developers who know C, but not necessarily your macros.</p>
</blockquote>
<h3 id="substitution">Substitution<a href="#substitution" class="hanchor" ariaLabel="Anchor">&#8983;</a> </h3>
<p><code>#define</code> statements may contain the invocation of other <code>#define</code> statements. Macros may not be recursive. Every uses of a macro is a direct text replacement and can massively bloat the size of the file to be compiled. This will execute marginally faster at the cost of code readability. By convention, all macro&rsquo;s should be defined in all upper case to differentiate from functions.</p>
<p>C will concatenate adjacent strings. Consider a macro that reports the formatted value of a statement. This will only work if a string literal, <code>&quot;%d&quot;</code>, is given as the macro argument.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-c" data-lang="c"><span style="color:#75715e">#define PRINT(FORMAT,VALUE)                   \
</span><span style="color:#75715e">  printf( &#34;The value is &#34; FORMAT &#34;\n&#34;, VALUE) \
</span><span style="color:#75715e">...
</span><span style="color:#75715e"></span>PRINT( <span style="color:#e6db74">&#34;%d&#34;</span>, <span style="color:#ae81ff">3</span> <span style="color:#f92672">*</span> <span style="color:#ae81ff">3</span>);
<span style="color:#75715e">/* The value is 9 */</span>
</code></pre></div><p>For concatenating non string literals, we must use the preprocessor to convert the argument into a string. <code>#VALUE</code> will be replaced with a string representation of the argument. e.g. <code>&quot;3 * 3 &quot;</code>.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-c" data-lang="c"><span style="color:#75715e">#define PRINT(FORMAT,VALUE)       \
</span><span style="color:#75715e">  printf( &#34;The value of &#34; #VALUE  \
</span><span style="color:#75715e">    &#34; is &#34; FORMAT &#34;\n&#34;, VALUE)
</span><span style="color:#75715e"></span>...
PRINT( <span style="color:#e6db74">&#34;%d&#34;</span>, <span style="color:#ae81ff">3</span> <span style="color:#f92672">*</span> <span style="color:#ae81ff">3</span>);
<span style="color:#75715e">/* The value of 3 * 3 is 9 */</span>
</code></pre></div><h4 id="-construct">## construct<a href="#-construct" class="hanchor" ariaLabel="Anchor">&#8983;</a> </h4>
<p><code>##</code> causes the token on their side of <code>##</code> to be concatenated. Note this bizarre method of dynamically assigning a variable ending in a number.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-c" data-lang="c"><span style="color:#75715e">#define WEIRD_DYNAMIC_VAR_ASSIGNMENT(var_num, value)  \
</span><span style="color:#75715e">                       var ## var_num = value
</span><span style="color:#75715e"></span>...
WEIRD_DYNAMIC_VAR_ASSIGNMENT(<span style="color:#ae81ff">5</span>, <span style="color:#ae81ff">100</span>);
<span style="color:#75715e">/* var5 = 100 */</span>
</code></pre></div><h3 id="undef">undef<a href="#undef" class="hanchor" ariaLabel="Anchor">&#8983;</a> </h3>
<p>Remove a definition. Usefully for re-defining a definition.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-c" data-lang="c"><span style="color:#75715e">#undef name
</span></code></pre></div><h3 id="command-line-define">Command line define<a href="#command-line-define" class="hanchor" ariaLabel="Anchor">&#8983;</a> </h3>
<p>Define definitions can come from the command line arguments to the compiler. <code>-U</code> will undefine.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">gcc -D name<span style="color:#f92672">=</span>definition
</code></pre></div><h3 id="143-conditional-compilation">14.3 Conditional Compilation<a href="#143-conditional-compilation" class="hanchor" ariaLabel="Anchor">&#8983;</a> </h3>
<p>Conditionally include and exclude sections of code. If the value of <code>constant-expression</code> is zero (false), the preprocessor will remove the block. <code>#else</code> and <code>#elsif</code> are valid as expected. Preprocessor statements may be nested.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-c" data-lang="c"><span style="color:#75715e">#if constant-expression
</span><span style="color:#75715e"></span>  ...
<span style="color:#75715e">#endif
</span></code></pre></div><p>A typical example of conditional compilation. DEBUG may be defined in any of the ways described.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-c" data-lang="c"><span style="color:#75715e">#if DEBUG
</span><span style="color:#75715e"></span>  printf(<span style="color:#e6db74">&#34;debugging output&#34;</span>);
<span style="color:#75715e">#endif
</span></code></pre></div><h4 id="if-defined">If Defined<a href="#if-defined" class="hanchor" ariaLabel="Anchor">&#8983;</a> </h4>
<p>Testing for the presence of definitions is supported.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-c" data-lang="c"><span style="color:#75715e">#if defined(symbol)
</span><span style="color:#75715e">#ifdef symbol
</span><span style="color:#75715e">#if !defined(symbol)
</span><span style="color:#75715e">#ifndef symbol
</span></code></pre></div><h3 id="library-and-local-includes">Library and local includes<a href="#library-and-local-includes" class="hanchor" ariaLabel="Anchor">&#8983;</a> </h3>
<p>Use angle brackets <code>&lt;filename&gt;</code> and double quotes <code>&quot;filename&quot;</code> to differentiate library and local includes.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-c" data-lang="c"><span style="color:#75715e">#include</span> <span style="color:#75715e">&lt;stdio.h&gt;</span><span style="color:#75715e">
</span><span style="color:#75715e">#include</span> <span style="color:#75715e">&#34;myfile.h&#34;</span><span style="color:#75715e">
</span></code></pre></div><p>Included files may themselves contain include statements. The Standard requires at least 8 levels of nested <code>#include</code> statements but does not specify a maximum. Convention dictates that there is little reason for more than two.</p>
<p>Complex programs may inadvertency cause the same file to be included multiple times. Use conditional compilation as a work around.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-c" data-lang="c"><span style="color:#75715e">#ifndef _SOMEHEADER_H
</span><span style="color:#75715e"></span>  <span style="color:#75715e">#define _SOMEHEADER_H
</span><span style="color:#75715e"></span>  <span style="color:#75715e">#include</span> <span style="color:#75715e">...</span><span style="color:#75715e">
</span><span style="color:#75715e">#endif
</span></code></pre></div>
      </div></div>

  
  
<div class="pagination">
    <div class="pagination__title">
        <span class="pagination__title-h">Read other posts</span>
        <hr />
    </div>
    <div class="pagination__buttons">
        
        
        <span class="button next">
            <a href="/posts/lecture-2/">
                <span class="button__text">Lecture 2</span>
                <span class="button__icon">→</span>
            </a>
        </span>
        
    </div>
</div>

  

  

</div>

  </div>

  
    <footer class="footer">
  <div class="footer__inner">
    
      <div class="copyright">
        <span>© 2021 Powered by <a href="http://gohugo.io">Hugo</a></span>
    
        <span>:: Theme made by <a href="https://twitter.com/panr">panr</a></span>
      </div>
  </div>
</footer>

<script src="/assets/main.js"></script>
<script src="/assets/prism.js"></script>







  
</div>

</body>
</html>
