<!DOCTYPE html>
<html lang="en">
<head>
  
    <title>Lecture 16 :: CSE 2421 TL;DR</title>
  
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="description" content="Lecture 16 Video : C_Function_Pointers Part A Video : C_Function_Pointers Part B
Slides : C_Function_Pointers
 If you thought pointers were strange, function pointers are stranger.
 Declare a function which returns a pointer. Find an int value in array and return a pointer to the found value.
int *findValue(int value, int size, const int *array); Function Pointer Function statements are stored in memory. We can find this location in memory." />
<meta name="keywords" content="" />
<meta name="robots" content="noodp" />
<link rel="canonical" href="/cse2421tldr/posts/lecture-16/" />




<link rel="stylesheet" href="/cse2421tldr/assets/style.css">






<link rel="apple-touch-icon" href="/cse2421tldr/img/apple-touch-icon-192x192.png">

  <link rel="shortcut icon" href="/cse2421tldr/img/favicon/orange.png">



<meta name="twitter:card" content="summary" />

  
    <meta name="twitter:site" content="" />
  
    <meta name="twitter:creator" content="" />



<meta property="og:locale" content="en" />
<meta property="og:type" content="article" />
<meta property="og:title" content="Lecture 16">
<meta property="og:description" content="C Function Pointers" />
<meta property="og:url" content="/cse2421tldr/posts/lecture-16/" />
<meta property="og:site_name" content="CSE 2421 TL;DR" />

  
    <meta property="og:image" content="/cse2421tldr/img/favicon/orange.png">
  

<meta property="og:image:width" content="2048">
<meta property="og:image:height" content="1024">


  <meta property="article:published_time" content="2021-02-11 02:30:11 -0500 -0500" />












</head>
<body class="orange">


<div class="container center headings--one-size">

  <header class="header">
  <div class="header__inner">
    <div class="header__logo">
      <a href="/cse2421tldr/">
  <div class="logo">
    CSE 2421 TL;DR
  </div>
</a>

    </div>
    
  </div>
  
</header>


  <div class="content">
    
<div class="post">
  <h1 class="post-title">
    <a href="/cse2421tldr/posts/lecture-16/">Lecture 16</a></h1>
  <div class="post-meta">
    
      <span class="post-date">
        2021-02-11 [Updated: 2021-02-11]
      </span>
    
    
  </div>

  
  <span class="post-tags">
    
    #<a href="/cse2421tldr/tags/function/">function</a>&nbsp;
    
    #<a href="/cse2421tldr/tags/pointer/">pointer</a>&nbsp;
    
    #<a href="/cse2421tldr/tags/c/">c</a>&nbsp;
    
  </span>
  

  

  

  <div class="post-content"><div>
        <h1 id="lecture-16">Lecture 16<a href="#lecture-16" class="hanchor" ariaLabel="Anchor">&#8983;</a> </h1>
<p><strong>Video</strong> : <a href="https://osu.zoom.us/rec/play/8lboG9poUPLHXz_wdn-H26I2NH9QhofscX7ukV_CYlDo8nvKviTNyrQT2BaBcNOIPNdFHWosVxo1Oue7.EEYKXdYDQeJ2sA-m?continueMode=true&amp;_x_zm_rtaid=jYBsbZNzRiaip23fAVhx3w.1613330917299.3536075cb21fcb7509065f857b904aeb&amp;_x_zm_rhtaid=767">C_Function_Pointers Part A</a>
<strong>Video</strong> : <a href="https://osu.zoom.us/rec/play/PJL3Jy9wf4dn8yhIa0IGFstO2aKLPkJxipodB0ZtcFBmfyp01Rtbv18TWj0zgs4nzuccvMP2_9QRB9dZ.lVjCEk46zjnQsrts?continueMode=true&amp;_x_zm_rtaid=jYBsbZNzRiaip23fAVhx3w.1613330917299.3536075cb21fcb7509065f857b904aeb&amp;_x_zm_rhtaid=767">C_Function_Pointers Part B</a></p>
<p><strong>Slides</strong> : <a href="https://osu.instructure.com/courses/95904/files/folder/Class%20slides?preview=29492072">C_Function_Pointers</a></p>
<blockquote>
<p>If you thought pointers were strange, function pointers are stranger.</p>
</blockquote>
<p>Declare a function which returns a pointer. Find an int value in <code>array</code> and return a pointer to the found value.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-c" data-lang="c"><span style="color:#66d9ef">int</span> <span style="color:#f92672">*</span><span style="color:#a6e22e">findValue</span>(<span style="color:#66d9ef">int</span> value, <span style="color:#66d9ef">int</span> size, <span style="color:#66d9ef">const</span> <span style="color:#66d9ef">int</span> <span style="color:#f92672">*</span>array);
</code></pre></div><h2 id="function-pointer">Function Pointer<a href="#function-pointer" class="hanchor" ariaLabel="Anchor">&#8983;</a> </h2>
<p>Function statements are stored in memory. We can find this location in memory.  This is a pointer to a function (pointer function) which returns an int, named <code>funcP</code>. The location of the parenthesis <code>()</code> in the following example are critical to differentiate this statement from the example <code>*findValue</code> above.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-c" data-lang="c"><span style="color:#66d9ef">int</span> (<span style="color:#f92672">*</span>funcP)();
</code></pre></div><p>Initialize and use such a pointer. The identifier name <code>fp</code> is kind of hard to spot.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-c" data-lang="c"><span style="color:#66d9ef">int</span> <span style="color:#a6e22e">returnMax</span>(<span style="color:#66d9ef">int</span> size, <span style="color:#66d9ef">const</span> <span style="color:#66d9ef">int</span> <span style="color:#f92672">*</span>array);
...
<span style="color:#66d9ef">int</span> (<span style="color:#f92672">*</span>fp)(<span style="color:#66d9ef">int</span>, <span style="color:#66d9ef">const</span> <span style="color:#66d9ef">int</span><span style="color:#f92672">*</span>);
fp <span style="color:#f92672">=</span> <span style="color:#f92672">&amp;</span>returnMax;
</code></pre></div><p>We can combine the declaration and assignment into a single statement.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-c" data-lang="c"><span style="color:#66d9ef">int</span> (<span style="color:#f92672">*</span>fp)(<span style="color:#66d9ef">int</span>, <span style="color:#66d9ef">const</span> <span style="color:#66d9ef">int</span><span style="color:#f92672">*</span>) <span style="color:#f92672">=</span> <span style="color:#f92672">&amp;</span>returnMax;
</code></pre></div><p>A function pointer must declare all type information. As a counter example. The following assignment is invalid. The second argument <code>upper</code> is a mismatch between <code>int</code> and <code>const int *</code>. Argument 3 is missing entirely.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-c" data-lang="c"><span style="color:#66d9ef">long</span> <span style="color:#a6e22e">returnLow</span>(<span style="color:#66d9ef">int</span> lower, <span style="color:#66d9ef">int</span> upper, <span style="color:#66d9ef">char</span> <span style="color:#f92672">*</span>values);
...
<span style="color:#66d9ef">int</span> (<span style="color:#f92672">*</span>fp)(<span style="color:#66d9ef">int</span>, <span style="color:#66d9ef">const</span> <span style="color:#66d9ef">int</span> <span style="color:#f92672">*</span>);
fp <span style="color:#f92672">=</span> <span style="color:#f92672">&amp;</span>returnLow; <span style="color:#75715e">/* Any mismatch is an invalid assignment. */</span>
</code></pre></div><p>The address operator is optional when getting function addresses and normally omitted.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-c" data-lang="c">fp <span style="color:#f92672">=</span> <span style="color:#f92672">&amp;</span>returnMax;
fp <span style="color:#f92672">=</span> returnMax;
</code></pre></div><h2 id="calling-a-function-with-a-function-pointer">Calling a function with a function pointer<a href="#calling-a-function-with-a-function-pointer" class="hanchor" ariaLabel="Anchor">&#8983;</a> </h2>
<p>Again the use of parenthesis here is critical to get the correct behavior.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-c" data-lang="c"><span style="color:#66d9ef">int</span> i <span style="color:#f92672">=</span> (<span style="color:#f92672">*</span>fp)(argument1, argument2);
</code></pre></div><p>Like the optional address operator <code>&amp;</code> for function pointers, the dereference operator <code>*</code> is also optional.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-c" data-lang="c"><span style="color:#66d9ef">int</span> i <span style="color:#f92672">=</span> fp(argument1, argument2);
</code></pre></div><h2 id="uses-of-function-pointers">Uses of function pointers<a href="#uses-of-function-pointers" class="hanchor" ariaLabel="Anchor">&#8983;</a> </h2>
<p>Advanced techniques such as <strong>callbacks</strong> and <strong>run-time-binding</strong> which are outside the scope of those course.</p>
<h3 id="replace-switchif-statements">Replace switch/if statements<a href="#replace-switchif-statements" class="hanchor" ariaLabel="Anchor">&#8983;</a> </h3>
<p>We can select functions to call like accessing elements of an array. By the nature of arrays, an array of function pointers must all be of the same return type and have the same type and order of parameters.</p>
<p>Suppose we wish to display a menu of math commands that a user can choose to execute.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-c" data-lang="c"><span style="color:#66d9ef">float</span> <span style="color:#a6e22e">add</span>(<span style="color:#66d9ef">float</span> a, <span style="color:#66d9ef">float</span> b);
<span style="color:#66d9ef">float</span> <span style="color:#a6e22e">subtract</span>(<span style="color:#66d9ef">float</span> a, <span style="color:#66d9ef">float</span> b);
<span style="color:#66d9ef">float</span> <span style="color:#a6e22e">multiply</span>(<span style="color:#66d9ef">float</span> a, <span style="color:#66d9ef">float</span> b);
<span style="color:#66d9ef">float</span> <span style="color:#a6e22e">divide</span>(<span style="color:#66d9ef">float</span> a, <span style="color:#66d9ef">float</span> b);
</code></pre></div><p>Declare an array of function pointers and store the addresses of these functions.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-c" data-lang="c"><span style="color:#66d9ef">float</span> (<span style="color:#f92672">*</span>fp_array[<span style="color:#ae81ff">4</span>])(<span style="color:#66d9ef">float</span>, <span style="color:#66d9ef">float</span>) <span style="color:#f92672">=</span> {add, subtract, multiply, divided }
</code></pre></div><p>Get user input, likely <code>scarf</code> but how isn&rsquo;t important.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-c" data-lang="c"><span style="color:#66d9ef">return</span> fp_array[userOption](userValue1, userValue2));
</code></pre></div><p>It&rsquo;s likely desirable to want to access fp_array outside the scope where it was declared. Pass the command array as a pointer, which becomes a pointer to a pointer. The deference operator is still not required because the array accessor <code>[]</code> handles the outer dereference.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-c" data-lang="c"><span style="color:#66d9ef">float</span> <span style="color:#a6e22e">doCommand</span>(<span style="color:#66d9ef">float</span> (<span style="color:#f92672">**</span>fp_array(<span style="color:#66d9ef">float</span>,<span style="color:#66d9ef">float</span>)), <span style="color:#66d9ef">int</span> command, <span style="color:#66d9ef">float</span> value1, <span style="color:#66d9ef">float</span> value2) {
  <span style="color:#66d9ef">return</span> fp_array[command](value1, value2));
}
...
doCommand(fp_array, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>);
</code></pre></div>
      </div></div>

  
  
<div class="pagination">
    <div class="pagination__title">
        <span class="pagination__title-h">Read other posts</span>
        <hr />
    </div>
    <div class="pagination__buttons">
        
        
        <span class="button next">
            <a href="/cse2421tldr/posts/lecture-14/">
                <span class="button__text">Lecture 14</span>
                <span class="button__icon">→</span>
            </a>
        </span>
        
    </div>
</div>

  

  

</div>

  </div>

  
    <footer class="footer">
  <div class="footer__inner">
    
      <div class="copyright">
        <span>© 2021 Powered by <a href="http://gohugo.io">Hugo</a></span>
    
        <span>:: Theme made by <a href="https://twitter.com/panr">panr</a></span>
      </div>
  </div>
</footer>

<script src="/cse2421tldr/assets/main.js"></script>
<script src="/cse2421tldr/assets/prism.js"></script>







  
</div>

</body>
</html>
